# テスト駆動開発の実践メモ

## TODOリスト
- [ ] $5 + 10 CHF = $10（レートが2:1の場合）
- [ ] $5 + $5 = $10
- [x] $5 * 2 = $10
- [ ] amountをprivateにする
- [ ] Dollarの副作用をどうする？
- [x] Moneyの丸め処理をどうする？
- [ ] equals()の実装
- [ ] hashCode()の実装
- [ ] nullとの等価性比較
- [ ] 他のオブジェクトとの等価性比較

## 第1章：仮実装

### チェックポイント
- [x] 最初の失敗するテストを書く
- [x] 仮実装でテストを通す
- [x] 実装を改善する

### TDDサイクルの実行メモ

#### RED
- テストの意図：最もシンプルな機能から始める（Dollar型の掛け算）
- 実装する機能：金額と数値を掛け合わせる基本的な計算
- 期待される失敗：クラスが存在しないことによるコンパイルエラー

#### GREEN
- 仮実装の方針：最小限のコードでテストを通す
- 最小限の実装内容：ハードコードされた値を返す
- 検証ポイント：テストが通ることのみを目的とする

#### REFACTORING
- リファクタリングの目的：実際の計算ロジックの実装
- 改善ポイント：ハードコードから実際の計算への移行
- 設計の意図：金額を扱うクラスの基本構造の確立

### 気づき・学び
- TDDのプラクティスについて
  - 最小限の失敗するテストから始めることの重要性
  - 仮実装の役割と意義
  - テストが先にあることで、必要最小限の実装に集中できる
- 設計の選択について
  - 金額を扱うクラスの責務の明確化
  - 値オブジェクトとしての設計の検討
  - 可視性（public/private）の検討が必要
- TypeScriptでの実装のポイント
  - クラス定義とアクセス修飾子の使用
  - 型安全性の確保
  - メソッドの戻り値の型定義の重要性

## 第2章：明白な実装

### 作業の進め方

#### 1. 各サイクルの開始時
- [ ] 現在の問題点の特定
- [ ] 変更目的の明確化
- [ ] 期待される結果の記述

#### 2. RED（テスト作成/修正）
- [ ] テストコードの追加/修正
- [ ] テストの失敗を確認
- [ ] コミット
  - メッセージ形式：`test: 〇〇のテストを追加`
  - 説明：テストの意図と期待される失敗を記述

#### 3. GREEN（実装）
- [ ] 最小限の実装を追加
- [ ] テストの成功を確認
- [ ] コミット
  - メッセージ形式：`feat: 〇〇の機能を実装`
  - 説明：実装内容と選択理由を記述

#### 4. REFACTOR（改善）
- [ ] コードの改善
- [ ] テストの維持を確認
- [ ] コミット
  - メッセージ形式：`refactor: 〇〇を改善`
  - 説明：改善内容と理由を記述

#### 5. サイクル完了時
- [ ] 学びと気づきの記録
- [ ] 次のサイクルの課題の特定
- [ ] 変更履歴の確認

### 実装サイクル

### 第1回サイクル：値オブジェクトの副作用除去

#### 現状の課題
- Dollarクラスのtimesメソッドに副作用がある
- オブジェクトの状態が変更されてしまう
- 値オブジェクトとしての性質が保たれていない

#### 変更目的
- timesメソッドを副作用のない実装に変更
- 新しいインスタンスを返す設計への移行
- 値オブジェクトとしての性質の確保

#### 期待される結果
- timesメソッドが新しいDollarインスタンスを返す
- 元のオブジェクトの状態が変更されない
- テストが意図通りに通過する

#### RED
- テストの意図：副作用の問題を明確にする
- 実装する機能：値オブジェクトとしての振る舞い
- 期待される失敗：オブジェクトの状態が変化してしまう

#### GREEN
- 仮実装の方針：新しいオブジェクトを返す実装
- 最小限の実装内容：計算結果を持つ新しいインスタンスの作成
- 検証ポイント：副作用がないことの確認

#### REFACTORING
- リファクタリングの目的：値オブジェクトの不変性の確保
- 改善ポイント：メソッドの戻り値の型定義
- 設計の意図：副作用のない計算の実現
